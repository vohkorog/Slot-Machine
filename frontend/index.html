<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û–¥–Ω–æ—Ä—É–∫–∏–π –±–∞–Ω–¥–∏—Ç (Python edition)</title>
    <style>
        /* –°—Ç–∏–ª–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ –∂–µ) */
        body { background: #2a5c3e; display: flex; justify-content: center; align-items: center; min-height: 100vh; font-family: 'Courier New', monospace; }
        .machine { background: #d4af37; padding: 30px; border-radius: 30px; box-shadow: 0 10px 0 #8b6910; }
        .reels { background: black; padding: 20px; border-radius: 20px; display: flex; gap: 20px; margin-bottom: 30px; }
        .reel { width: 100px; height: 100px; background: white; border-radius: 10px; display: flex; justify-content: center; align-items: center; font-size: 4em; font-weight: bold; }
        #lever { background: #c41e3a; color: white; border: none; font-size: 1.5em; padding: 15px 30px; border-radius: 50px; cursor: pointer; width: 100%; }
        #message { text-align: center; font-size: 1.2em; color: white; }
        .reel-spin { opacity: 0.7; transform: scale(0.95); background-color: #ffffe0; }
    </style>
</head>
<body>
    <div class="machine">
        <div class="reels">
            <div class="reel" id="reel1">?</div>
            <div class="reel" id="reel2">?</div>
            <div class="reel" id="reel3">?</div>
        </div>
        <button id="lever">üí™ –î–µ—Ä–Ω—É—Ç—å —Ä—ã—á–∞–≥</button>
        <p id="message">–ù–∞–∂–º–∏ –Ω–∞ —Ä—ã—á–∞–≥!</p>
    </div>

    <script>
        const reel1 = document.getElementById('reel1');
        const reel2 = document.getElementById('reel2');
        const reel3 = document.getElementById('reel3');
        const leverButton = document.getElementById('lever');
        const messageDisplay = document.getElementById('message');

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
        function startSpinAnimation() {
            reel1.classList.add('reel-spin');
            reel2.classList.add('reel-spin');
            reel3.classList.add('reel-spin');
            messageDisplay.textContent = 'üé∞ –°–≤—è–∑—ã–≤–∞–µ–º—Å—è —Å Python... üé∞';
            leverButton.disabled = true;
        }

        function stopSpinAnimation() {
            reel1.classList.remove('reel-spin');
            reel2.classList.remove('reel-spin');
            reel3.classList.remove('reel-spin');
            leverButton.disabled = false;
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ Python-—Å–µ—Ä–≤–µ—Ä–∞
        async function callPythonSpin() {
            startSpinAnimation();
            
            try {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ –Ω–∞—à Flask-—Å–µ—Ä–≤–µ—Ä
                const response = await fetch('http://localhost:5000/api/spin', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ bet: 1 }) // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å—Ç–∞–≤–∫—É
                });
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }
                
                const data = await response.json();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç Python
                reel1.textContent = data.reels[0];
                reel2.textContent = data.reels[1];
                reel3.textContent = data.reels[2];
                messageDisplay.textContent = data.message;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                messageDisplay.textContent = 'üòµ –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å Python!';
                reel1.textContent = '?';
                reel2.textContent = '?';
                reel3.textContent = '?';
            } finally {
                stopSpinAnimation();
            }
        }

        // –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É
        leverButton.addEventListener('click', callPythonSpin);
    </script>
</body>
</html>